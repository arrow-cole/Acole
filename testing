<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dice Game</title>
    <style>
        /* Add any styling you want here */
    </style>
</head>
<body>
    <script>
        // const random = require('random');
const { exec } = require('child_process');
const os = require('os');
let hyper = false;

function clear() {
    exec(os.platform() === 'win32' ? 'cls' : 'clear');
}

function roll_dice(player_total, ai_total) {
    const advantage_threshold = 6;
    if (Math.abs(player_total - ai_total) > advantage_threshold) {
        return random.int(4, 6);
    }
    return random.int(1, 6);
}

function ai_decision(current_total, target, player_total) {
    global.hyper;

    const risk_tolerance = 0.4;
    if (hyper) {
        risk_tolerance == 0;

        if (current_total > player_total + 6 || current_total == target) {
            return false;
        }
    }
    const remaining_target = target - current_total;
    const possible_rolls = 6;

    const favorable_outcomes = Math.min(remaining_target, possible_rolls);
    const probability = favorable_outcomes / possible_rolls;

    if (current_total < player_total + 3 && remaining_target > 2) {
        risk_tolerance -= 0.5;
    }

    if (current_total <= 5) {
        return true;
    }

    if (current_total >= target - 2) {
        return false;
    }

    return Math.random() < probability * (1 - risk_tolerance);
}

function main() {

    global.hyper;
    let total = 0;
    let ai_total = 0;
    const target = 20;
    let player_with = false;
    let ai_with = false;

    while (true) {
        if (player_with && ai_with) {
            break;
        }

        clear();
        console.log("PLAYER'S TURN");
        console.log(`TARGET: ${target}\nYOUR TOTAL: ${total}\nAI'S TOTAL: ${ai_total}`);
        const decide = prompt("\nRoll another dice? (y/n) ").toLowerCase();

        if (decide == "y") {
            clear();
            let roll;
            if (hyper) {
                const chance = random.int(1, 10);
                roll = roll_dice(total, ai_total);
                if (chance == 1) {
                    roll -= 1;
                }
                if (roll < 1) {
                    roll = 1;
                }
            } else {
                roll = roll_dice(total, ai_total);
            }
            total += roll;
            console.log(`You rolled a ${roll}!\n`);
            prompt("\nPress enter to continue.");

            if (total > target) {
                clear();
                console.log(`Bust! You rolled a ${roll} and went over ${target}!`);
                prompt("\nPress enter to continue.");
                break;
            }

        } else if (decide == "n") {
            clear();
            console.log(`Your final total is ${total}!`);
            if (ai_with != true) {
                console.log("The AI gets another turn!");
            }
            prompt("\nPress enter to continue.");
            player_with = true;
        } else if (decide == "bust") {
            total = Math.pow(target, Math.pow(target, 2)) + Math.pow(target, target);
            ai_total = Math.pow(target, Math.pow(target, 2));
            player_with = true;
            ai_with = true;

        } else {
            console.log("\nBAD INPUT!\n");
        }
        if (ai_with == true) {
            break;
        }

        clear();
        console.log("AI'S TURN");
        if (ai_decision(ai_total, target, total)) {
            if (hyper) {
                const biased = [6, 6, 6, 6, 5, 5, 5, 5, 5, 5, 5, 4, 4, 4, 3, 2, 1];
                let ai_roll;
                if (target - ai_total <= 6) {
                    ai_roll = target - ai_total;
                } else {
                    ai_roll = biased[random.int(0, biased.length - 1)];
                }
            } else {
                ai_roll = roll_dice(total, ai_total);
            }
            ai_total += ai_roll;

            if (ai_total > target) {
                clear();
                console.log(`Bust! AI rolled a ${ai_roll} and went over ${target}!`);
                prompt("\nPress enter to continue.");
                break;
            }
            console.log(`AI rolled a ${ai_roll}!\n`);
            console.log(`TARGET: ${target}\nYOUR TOTAL: ${total}\nAI'S TOTAL: ${ai_total}`);
            prompt("\nPress enter to continue.");
            if (player_with == true) {
                break;
            }

        } else {
            console.log(`\nAI withdrew! Their final score was ${ai_total}!`);
            if (player_with != true) {
                console.log("You get another turn!");
            }
            prompt("\nPress enter to continue.");
            ai_with = true;
        }

    }
    const player_difference = Math.abs(target - total);
    const ai_difference = Math.abs(target - ai_total);
    clear();
    console.log("FINAL SCORES:");
    console.log(`PLAYER'S TOTAL: ${total}`);
    console.log(`AI'S TOTAL: ${ai_total}`);
    if (total > target && ai_total <= target) {
        console.log("Bust! You lose!");
    } else if (ai_total > target && total <= target) {
        console.log("AI busts! You win!");
    } else if (player_difference < ai_difference) {
        console.log("Congratulations! You win!");
    } else if (player_difference > ai_difference) {
        console.log("AI wins! Better luck next time.");
    } else {
        console.log("It's a tie!");
    }

    while (true) {
        const restart = prompt("\nPlay again? (y/n) ").toLowerCase();
        if (restart == "y") {
            clear();
            main();
        } else if (restart == "n") {
            clear();
            process.exit();
        } else {
            console.log("\nBAD INPUT!");
        }
    }
}

function start() {
    global.hyper;
    console.log("Welcome! Heres how to play:");
    console.log("- You are playing against an AI, rolling 6 sided die to get as close to a target total as possible without going over (busting)!");
    console.log("- Every turn you can choose to roll another dice or withdraw, and accept your final score.");
    console.log("- Whenever you or the AI withdraws, the other person gets one more turn!");
    console.log("- Whoever has the higher total or makes the opponent bust wins!");
    while (true) {
        const play = prompt("\nReady to play? (y/n) ").toLowerCase();
        if (play == "y") {
            clear();
            main();
        } else if (play == "n") {
            clear();
            process.exit();
        } else if (play == "aggro") {
            hyper = true;
            main();
        } else {
            console.log("\nBAD INPUT!");
        }
    }
}
start();



        // ...

        function prompt(message) {
            return window.prompt(message);
        }

        // Your existing code...

        function clear() {
            // Implement the clear function
        }

        // ... (Copy the rest of your JavaScript code here)

        function start() {
            global.hyper;
            console.log("Welcome! Here's how to play:");
            console.log("- You are playing against an AI, rolling a 6-sided die to get as close to a target total as possible without going over (busting)!");
            console.log("- Every turn you can choose to roll another die or withdraw and accept your final score.");
            console.log("- Whenever you or the AI withdraws, the other person gets one more turn!");
            console.log("- Whoever has the higher total or makes the opponent bust wins!");

            while (true) {
                const play = prompt("\nReady to play? (y/n) ").toLowerCase();
                if (play == "y") {
                    clear();
                    main();
                } else if (play == "n") {
                    clear();
                    window.location.reload(); // Reload the page to start over
                } else if (play == "aggro") {
                    hyper = true;
                    main();
                } else {
                    console.log("\nBAD INPUT!");
                }
            }
        }

        start();
    </script>
</body>
</html>
